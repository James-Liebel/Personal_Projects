<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>United States GDP Visualization</title>
  <script src="https://d3js.org/d3.v7.min.js"></script>
  <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;600&display=swap" rel="stylesheet">
  <style>
    :root {
      --primary: #3498db;
      --secondary: #2c3e50;
      --accent: #e74c3c;
      --bg: #ffffff;
      --text: #333;
    }

    body {
      font-family: 'Outfit', sans-serif;
      margin: 0;
      display: flex;
      justify-content: center;
      align-items: center;
      height: 100vh;
      background: #f8f9fa;
    }

    .container {
      background: white;
      padding: 30px;
      border-radius: 20px;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
      position: relative;
    }

    #title {
      font-size: 28px;
      font-weight: 600;
      color: var(--secondary);
      margin-bottom: 20px;
      text-align: center;
    }

    .bar {
      fill: #3498db;
      transition: fill 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    }

    .bar:hover {
      fill: #2980b9;
    }

    #tooltip {
      position: absolute;
      padding: 12px;
      background: rgba(44, 62, 80, 0.95);
      color: white;
      border-radius: 8px;
      pointer-events: none;
      opacity: 0;
      font-size: 14px;
      box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
      backdrop-filter: blur(4px);
      transition: opacity 0.2s;
      z-index: 10;
    }

    .tick text {
      font-size: 12px;
      color: #666;
    }

    .axis-label {
      font-size: 14px;
      fill: #95a5a6;
    }

    svg {
      border-radius: 10px;
    }

    .grid line {
      stroke: #eee;
      stroke-opacity: 0.7;
      shape-rendering: crispEdges;
    }

    .grid path {
      stroke-width: 0;
    }
  </style>
</head>

<body>
  <div class="container">
    <h1 id="title">United States GDP Growth</h1>
    <div id="tooltip" data-date=""></div>
    <div id="chart-area"></div>
  </div>

  <script>
    const width = 800;
    const height = 500;
    const margin = { top: 40, right: 40, bottom: 60, left: 80 };

    const svg = d3.select("#chart-area")
      .append("svg")
      .attr("width", width)
      .attr("height", height)
      .append("g")
      .attr("transform", `translate(${margin.left},${margin.top})`);

    d3.json("https://raw.githubusercontent.com/freeCodeCamp/ProjectReferenceData/master/GDP-data.json")
      .then(data => {
        const dataset = data.data;

        const xExtent = d3.extent(dataset, d => new Date(d[0]));
        const xScale = d3.scaleTime()
          .domain(xExtent)
          .range([0, width - margin.left - margin.right]);

        const yScale = d3.scaleLinear()
          .domain([0, d3.max(dataset, d => d[1])])
          .range([height - margin.top - margin.bottom, 0]);

        // X Axis
        const xAxis = d3.axisBottom(xScale).ticks(10);
        svg.append("g")
          .attr("id", "x-axis")
          .attr("transform", `translate(0, ${height - margin.top - margin.bottom})`)
          .call(xAxis)
          .attr("color", "#7f8c8d");

        // Y Axis
        const yAxis = d3.axisLeft(yScale);
        svg.append("g")
          .attr("id", "y-axis")
          .call(yAxis)
          .attr("color", "#7f8c8d");

        // Y Axis Label
        svg.append("text")
          .attr("transform", "rotate(-90)")
          .attr("y", -60)
          .attr("x", -(height - margin.top - margin.bottom) / 2)
          .attr("class", "axis-label")
          .style("text-anchor", "middle")
          .text("Gross Domestic Product (Billions)");

        // Bars
        const barWidth = (width - margin.left - margin.right) / dataset.length;

        const tooltip = d3.select("#tooltip");

        svg.selectAll(".bar")
          .data(dataset)
          .enter()
          .append("rect")
          .attr("class", "bar")
          .attr("data-date", d => d[0])
          .attr("data-gdp", d => d[1])
          .attr("x", (d, i) => i * barWidth)
          .attr("y", height - margin.top - margin.bottom) // Start from bottom for animation
          .attr("width", barWidth)
          .attr("height", 0) // Start with 0 height
          .on("mouseover", (event, d) => {
            const date = new Date(d[0]);
            const year = date.getFullYear();
            const quarter = Math.floor(date.getMonth() / 3) + 1;

            tooltip.transition().duration(100).style("opacity", 1);
            tooltip.html(`${year} Q${quarter}<br>$${d[1].toLocaleString()} Billion`)
              .style("left", (event.pageX + 15) + "px")
              .style("top", (event.pageY - 40) + "px")
              .attr("data-date", d[0]);
          })
          .on("mouseout", () => {
            tooltip.transition().duration(400).style("opacity", 0);
          })
          .transition() // Entrance animation
          .duration(1000)
          .delay((d, i) => i * 2)
          .attr("y", d => yScale(d[1]))
          .attr("height", d => (height - margin.top - margin.bottom) - yScale(d[1]));

      })
      .catch(error => console.error("Error loading the data: ", error));
  </script>
</body>

</html>